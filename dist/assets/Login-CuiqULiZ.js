import{r,j as e}from"./index-CSak_wTG.js";import{u as j}from"./AuthContext-Bg7guHVU.js";import{u as v}from"./ToastContext-ykpRnyEW.js";import{u as b}from"./index-jxamHYc2.js";import{Q as y}from"./qr-code-C8MP7_mu.js";import{A as k}from"./alert-circle-DlXK4dQC.js";import{M as w}from"./mail-DPK31KfG.js";import{L as N}from"./lock-E-Ocy_GT.js";import{c as E}from"./createLucideIcon-6Q1StMY_.js";import{E as S}from"./eye-Cxhe0FSq.js";const L=E("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]),O=()=>{const[i,u]=r.useState(""),[t,g]=r.useState(""),[l,x]=r.useState(!1),[o,c]=r.useState(!1),[m,n]=r.useState(""),{signIn:h}=j(),{error:p}=v();b();const f=async a=>{if(a.preventDefault(),n(""),!i||!t){n("Email dan password harus diisi"),p("Email dan password harus diisi");return}console.log("[Login] Attempting login for:",i),c(!0);const{data:M,error:d}=await h(i,t);if(c(!1),d){console.error("[Login] Login failed:",d);let s=d.message;s.includes("Invalid login credentials")?s="Email atau password salah":s.includes("Email not confirmed")?s="Email belum dikonfirmasi":s.includes("Invalid API key")?s="Konfigurasi Supabase tidak valid. Periksa ANON KEY di .env":s.includes("Failed to fetch")&&(s="Tidak dapat terhubung ke server. Periksa koneksi internet dan URL Supabase."),n(s),p(s);return}console.log("[Login] Login successful!")};return e.jsx("div",{className:"login-page",children:e.jsxs("div",{className:"login-card",children:[e.jsxs("div",{className:"login-header",children:[e.jsxs("div",{className:"login-logo",children:[e.jsx("div",{className:"login-logo-icon",children:e.jsx(y,{size:28})}),e.jsx("span",{children:"Berkas RM"})]}),e.jsx("p",{className:"login-tagline",children:"Sistem Pelacakan Rekam Medis"})]}),e.jsxs("form",{className:"login-body",onSubmit:f,children:[m&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",padding:"12px",marginBottom:"16px",background:"var(--error-light)",color:"#b91c1c",borderRadius:"var(--radius-lg)",fontSize:"0.875rem"},children:[e.jsx(k,{size:18}),e.jsx("span",{children:m})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",htmlFor:"email",children:"Email"}),e.jsxs("div",{style:{position:"relative"},children:[e.jsx(w,{size:18,style:{position:"absolute",left:"12px",top:"50%",transform:"translateY(-50%)",color:"var(--text-muted)"}}),e.jsx("input",{type:"email",id:"email",className:"form-input",placeholder:"nama@rumahsakit.com",value:i,onChange:a=>u(a.target.value),style:{paddingLeft:"40px"},autoComplete:"email",disabled:o})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",htmlFor:"password",children:"Password"}),e.jsxs("div",{style:{position:"relative"},children:[e.jsx(N,{size:18,style:{position:"absolute",left:"12px",top:"50%",transform:"translateY(-50%)",color:"var(--text-muted)"}}),e.jsx("input",{type:l?"text":"password",id:"password",className:"form-input",placeholder:"Masukkan password",value:t,onChange:a=>g(a.target.value),style:{paddingLeft:"40px",paddingRight:"40px"},autoComplete:"current-password",disabled:o}),e.jsx("button",{type:"button",onClick:()=>x(!l),style:{position:"absolute",right:"12px",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",cursor:"pointer",color:"var(--text-muted)",padding:"4px"},children:l?e.jsx(L,{size:18}):e.jsx(S,{size:18})})]})]}),e.jsx("button",{type:"submit",className:"btn btn-primary btn-block btn-lg mt-lg",disabled:o,children:o?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"spinner",style:{width:20,height:20}}),e.jsx("span",{children:"Memproses..."})]}):e.jsx("span",{children:"Masuk"})}),e.jsxs("div",{style:{marginTop:"16px",padding:"12px",background:"var(--gray-100)",borderRadius:"var(--radius-md)",fontSize:"0.75rem",color:"var(--text-muted)"},children:[e.jsx("strong",{children:"Debug:"})," Buka Browser Console (F12) untuk melihat log detail"]})]}),e.jsx("div",{className:"login-footer",children:e.jsx("p",{children:"Rekam Medis Tracer System Â© 2026"})})]})})};export{O as default};
