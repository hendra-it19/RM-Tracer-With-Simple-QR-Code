import{r as t,j as s,L as C}from"./index-CSak_wTG.js";import{u as z}from"./AuthContext-Bg7guHVU.js";import{u as L}from"./ToastContext-ykpRnyEW.js";import{u as D}from"./index-jxamHYc2.js";import{M as U}from"./mail-DPK31KfG.js";import{S as A,K as E}from"./shield-C_HhIGfH.js";import{S as K}from"./save-By5oi_wf.js";import{U as M}from"./user-SuINNBmt.js";import{L as O}from"./log-out-DOrjjtQE.js";import"./createLucideIcon-6Q1StMY_.js";const Q=()=>{const g=D(),{profile:r,signOut:b,updateProfile:j,updatePassword:w}=z(),{success:f,error:n}=L(),[h,c]=t.useState(!1),[x,u]=t.useState(!1),[l,o]=t.useState(!1),[v,y]=t.useState(!1),[d,p]=t.useState({nama:r?.nama||""}),[e,m]=t.useState({newPassword:"",confirmPassword:""}),N=async a=>{if(a.preventDefault(),!d.nama){n("Nama harus diisi");return}o(!0);const{error:i}=await j({nama:d.nama});i?n("Gagal memperbarui profil"):(f("Profil berhasil diperbarui"),c(!1)),o(!1)},P=async a=>{if(a.preventDefault(),e.newPassword.length<6){n("Password minimal 6 karakter");return}if(e.newPassword!==e.confirmPassword){n("Password tidak cocok");return}o(!0);const{error:i}=await w(e.newPassword);i?n("Gagal mengubah password"):(f("Password berhasil diubah"),u(!1),m({newPassword:"",confirmPassword:""})),o(!1)},S=async()=>{confirm("Apakah Anda yakin ingin keluar aplikasi?")&&(y(!0),await new Promise(a=>setTimeout(a,800)),await b(),g("/login"))},k=a=>a?a.split(" ").map(i=>i[0]).join("").toUpperCase().slice(0,2):"U";return s.jsxs("div",{className:"flex flex-col gap-lg",children:[v&&s.jsx(C,{}),s.jsx("div",{className:"card",children:s.jsxs("div",{className:"card-body text-center",children:[s.jsx("div",{style:{width:80,height:80,borderRadius:"var(--radius-full)",background:"linear-gradient(135deg, var(--primary-500), var(--primary-700))",color:"white",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"2rem",fontWeight:600,margin:"0 auto var(--spacing-md)"},children:k(r?.nama)}),s.jsx("h2",{style:{fontSize:"1.25rem",fontWeight:600},children:r?.nama||"User"}),s.jsxs("div",{className:"flex items-center justify-center gap-sm text-secondary mt-xs",children:[s.jsx(U,{size:14}),s.jsx("span",{children:r?.email})]}),s.jsxs("div",{className:"badge badge-primary mt-md",style:{margin:"0 auto"},children:[s.jsx(A,{size:12}),r?.role==="admin"?"Administrator":"Petugas"]})]})}),s.jsxs("div",{className:"card",children:[s.jsxs("div",{className:"card-header flex justify-between items-center",children:[s.jsx("h3",{style:{fontSize:"1rem",fontWeight:600},children:"Informasi Profil"}),!h&&s.jsx("button",{className:"btn btn-ghost btn-sm",onClick:()=>c(!0),children:"Edit"})]}),s.jsx("div",{className:"card-body",children:h?s.jsxs("form",{onSubmit:N,children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{className:"form-label",children:"Nama Lengkap"}),s.jsx("input",{type:"text",className:"form-input",value:d.nama,onChange:a=>p({...d,nama:a.target.value}),required:!0})]}),s.jsxs("div",{className:"flex gap-sm",children:[s.jsx("button",{type:"button",className:"btn btn-secondary flex-1",onClick:()=>{c(!1),p({nama:r?.nama||""})},children:"Batal"}),s.jsxs("button",{type:"submit",className:"btn btn-primary flex-1",disabled:l,children:[s.jsx(K,{size:16}),l?"Menyimpan...":"Simpan"]})]})]}):s.jsxs("div",{className:"flex items-center gap-md",children:[s.jsx(M,{size:20,style:{color:"var(--text-muted)"}}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm text-secondary",children:"Nama"}),s.jsx("div",{className:"font-medium",children:r?.nama})]})]})})]}),s.jsxs("div",{className:"card",children:[s.jsxs("div",{className:"card-header flex justify-between items-center",children:[s.jsx("h3",{style:{fontSize:"1rem",fontWeight:600},children:"Keamanan"}),!x&&s.jsxs("button",{className:"btn btn-ghost btn-sm",onClick:()=>u(!0),children:[s.jsx(E,{size:14}),"Ganti Password"]})]}),x&&s.jsx("div",{className:"card-body",children:s.jsxs("form",{onSubmit:P,children:[s.jsxs("div",{className:"form-group",children:[s.jsx("label",{className:"form-label",children:"Password Baru"}),s.jsx("input",{type:"password",className:"form-input",value:e.newPassword,onChange:a=>m({...e,newPassword:a.target.value}),placeholder:"Minimal 6 karakter",minLength:6,required:!0})]}),s.jsxs("div",{className:"form-group",children:[s.jsx("label",{className:"form-label",children:"Konfirmasi Password"}),s.jsx("input",{type:"password",className:"form-input",value:e.confirmPassword,onChange:a=>m({...e,confirmPassword:a.target.value}),placeholder:"Ulangi password baru",required:!0})]}),s.jsxs("div",{className:"flex gap-sm",children:[s.jsx("button",{type:"button",className:"btn btn-secondary flex-1",onClick:()=>{u(!1),m({newPassword:"",confirmPassword:""})},children:"Batal"}),s.jsx("button",{type:"submit",className:"btn btn-primary flex-1",disabled:l,children:l?"Menyimpan...":"Simpan Password"})]})]})})]}),s.jsxs("button",{className:"btn btn-danger btn-block",onClick:S,children:[s.jsx(O,{size:18}),"Keluar dari Aplikasi"]})]})};export{Q as default};
